What ultimately forced us off TCMalloc in production was not stability, but its inconsistent memory economy: a heap containing a given number of allocated bytes would spread across an ever larger physical footprint over time. Multiple TCMalloc back-ends (search, ads, feed, etc.) would suffer 512MB-1GB of heap bloat per day, which meant it would be hitting swap within a few days.

Jemalloc has cured this symptom for us, while matching or beating TCMalloc for performance, scalability, and memory economy. Jason attributes jemalloc's stable physical footprint to its dirty page trimming; it uses heuristics to keep dirty free data co-located on the same pages, and return the backing store to the kernel via madvise. Tuning this to be effective is a minor miracle of systems engineering, so if you end up using jemalloc, buy je a beer or something.
